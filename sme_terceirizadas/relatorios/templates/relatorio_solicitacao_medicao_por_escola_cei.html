{% extends "relatorio_solicitacao_medicao_por_escola_base.html" %}
{% load index static sass_tags %}

{% block tabelas %}
    <!-- Página de tabelas -->
    {% for tabela in tabelas %}
        <header class="header" style="page-break-before: always;">
            <div class="row p-0 mx-4">
                <div class="col-2">
                    <img src="{% static 'images/LOGO_FUNDO_CLARO.png' %}" alt=""/>
                </div>
                <div class="col-8">
                    <h1 class="text-center">SECRETARIA MUNICIPAL DE EDUCAÇÃO - SME | COORDENADORIA DE ALIMENTAÇÃO ESCOLAR - CODAE</h1>
                    <h1 class="text-center">MEDIÇÃO INICIAL DO SERVIÇO DE NUTRIÇÃO E ALIMENTAÇÃO ESCOLAR</h1>
                </div>
                <div class="col-1"></div>
                <div class="col-1">
                    <h1 class="text-right">Página</h1>
                    <h1 class="page-number text-right"></h1>
                </div>
            </div>
            <div class="row p-0 mx-2">
                <div class="col-12">
                    <table class="tabela-cabecalho">
                        <tr class="custom-filtros">
                            <td><b>Cód. EOL: </b>{{ solicitacao.escola.codigo_eol }}</td>
                            <td><b>U.E: </b>{{ solicitacao.escola.nome }}</td>
                            <td><b>Telefone da UE: </b>{{ solicitacao.escola.contato.telefone }}</td>
                            <td><b>DRE: </b>{{ solicitacao.escola.diretoria_regional.nome }}</td>
                        </tr>
                        <tr class="custom-filtros">
                            <td><b>Lote: </b>{{ solicitacao.rastro_lote.nome }}</td>
                            <td colspan="2"><b>Empresa Prestadora do Serviço: </b>{{ solicitacao.rastro_terceirizada.razao_social }}</td>
                            <td><b>REFERÊNCIA: </b>{{ solicitacao.mes }}/{{ solicitacao.ano }}</td>
                        </tr>
                    </table>
                </div>
            </div>
        </header>

    <table class="tabela-valores-medicao mt-3">
      <thead class="texto-branco">
          <tr>
              <th rowspan="4">Dias</th>
              {% for periodo in tabela.periodos %}
                  <th class="periodo-grupo cor-periodo-grupo-{{ tabela.ordem_periodos_grupos|get_element_by_index:forloop.counter0 }}" colspan="{{ tabela.len_periodos|get_element_by_index:forloop.counter0 }}">
                      {{ periodo|upper }}
                  </th>
              {% endfor %}
          </tr>
          <tr>
              {% for categoria in tabela.categorias %}
                  <th class="categoria" colspan="{{ tabela.len_categorias|get_element_by_index:forloop.counter0 }}">{{ categoria.categoria|upper }}</th>
              {% endfor %}
          </tr>
          <tr>
            {% for categoria in tabela.categorias %}
                {% for faixa in categoria.faixas_etarias %}
                    {% if faixa == "total" %}
                        <th  class="faixa-etaria" colspan="1"></th>
                    {% else %}
                      <th class="faixa-etaria" colspan="2">{{ faixa }}</th>
                    {% endif %}
                {% endfor %}
            {% endfor %}
          </tr>
          <tr>
            {% for categoria in tabela.categorias %}
                {% for faixa in categoria.faixas_etarias %}
                    {% if faixa == "total" %}
                        <th  class="faixa-etaria" > Total do Dia</th>
                    {% else %}
                      {% if categoria.categoria == "ALIMENTAÇÃO" %}
                          <th>Matriculados</th>
                          <th>Frequência</th>
                      {% elif categoria.categoria == "DIETA TIPO A" or categoria.categoria == "DIETA TIPO B" %}
                          <th>Aprovadas</th>
                          <th>Frequência</th>
                      {% endif %}
                    {% endif %}
                {% endfor %}
            {% endfor %}
          </tr>
      </thead>

      <tbody>
        {% for valores in tabela.valores_campos %}
          <tr class="{% if dias_letivos|get_nao_eh_dia_letivo:forloop.counter0 %} nao-dia-letivo {% endif %}">
            {% for valor in valores %}
              <td>{{ valor }}</td>
            {% endfor %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endfor %}

 {% endblock %}
