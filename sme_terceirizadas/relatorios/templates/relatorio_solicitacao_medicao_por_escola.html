{% load index %}
{% load static %}
{% load sass_tags %}

<html>
<head>
  <link rel="stylesheet" href="{% sass_src 'css/custom_bootstrap.scss' %}" type="text/css">
  <link rel="stylesheet" href="{% sass_src 'css/relatorio_solicitacao_medicao_por_escola.scss' %}" type="text/css">
</head>
<body>
  <header class="header">
    <div class="row p-0 mx-4">
      <div class="col-2">
        <img src="{% static 'images/LOGO_FUNDO_CLARO.png' %}" alt=""/>
      </div>
      <div class="col-8">
        <h1 class="text-center">
          SECRETARIA MUNICIPAL DE EDUCAÇÃO - SME | COORDENADORIA DE ALIMENTAÇÃO ESCOLAR - CODAE
        </h1>
        <h1 class="text-center">
          MEDIÇÃO INICIAL DO SERVIÇO DE NUTRIÇÃO E ALIMENTAÇÃO ESCOLAR
        </h1>
      </div>
      <div class="col-1"></div>
      <div class="col-1">
        <h1 class="text-right">Página</h1>
        <h1 class="page-number text-right"></h1>
      </div>
    </div>

    <div class="row p-0 mx-4">
      <div class="col-12">
        <table class="tabela-cabecalho table-bordered">
          <tr class="custom-filtros">
            <td><b>Cód. EOL: </b>{{ solicitacao.escola.codigo_eol }}</td>
            <td><b>U.E: </b>{{ solicitacao.escola.nome }}</td>
            <td><b>Telefone da UE: </b>{{ solicitacao.escola.contato.telefone }}</td>
            <td><b>DRE: </b>{{ solicitacao.escola.diretoria_regional.nome }}</td>
          </tr>
          <tr class="custom-filtros">
            <td><b>Lote: </b>{{ solicitacao.rastro_lote.nome }}</td>
            <td colspan="2"><b>Empresa Prestadora do Serviço: </b>{{ solicitacao.rastro_terceirizada.razao_social }}</td>
            <td><b>REFERÊNCIA: </b>{{ solicitacao.mes }}/{{ solicitacao.ano }}</td>
          </tr>
        </table>
      </div>
    </div>
  </header>
  <div class="row p-0 mx-4 my-5">
    <div class="col-12">
      <h1 class="text-center titulo-body-p1">INFORMAÇÕES BÁSICAS DA MEDIÇÃO</h1>
    </div>
  </div>

  <div class="row p-0 mx-4 tipo-contagem">
    <div class="col-2"></div>
    <div class="col-4 label-contagem">
      Método de Contagem das Alimentações Servidas
    </div>
    <div class="col-4 value-contagem">
      {{solicitacao.tipo_contagem_alimentacoes.nome}}
    </div>
    <div class="col-2"></div>
  </div>

  <div class="row p-0 mx-4 mt-5 tipo-avaliacao">
    <div class="col-3 avaliacao-left">
      Avaliação do Serviço
    </div>
    <div class="col-6 avaliacao-center">
      Neste mês, a direção da Unidade Educacional considera que o serviço foi realizado a contento?
    </div>
    <div class="col-3 avaliacao-right">
      {% if solicitacao.com_ocorrencias %}
      Não, com ocorrências
      {% else %}
      Sim, sem ocorrências
      {% endif %}
    </div>
  </div>
  <div class="mt-5"></div>
  <div class="row p-0 mx-4 mt-5">
    <div class="col-12 usuario-title"><span><b>Responsáveis por acompanhar a prestação de serviços</b></span></div>
  </div>
  {% for responsavel in responsaveis %}
  <div class="row p-0 mx-4 mt-2 usuarios">
    <div class="usuario-label mr-2"><span><b>Nome: {{responsavel.nome}}</b></span></div>
    <div class="usuario-values"><span><b>RF: {{responsavel.rf}}</b></span></div>
  </div>
  {% endfor %}
  <div class="mt-5"></div>
  <div class="row p-0 mx-4 mt-5">
    <div class="col-6 mr-3 titulo-assinatura">
      <b>ASSINATURA UNIDADE EDUCACIONAL</b>
    </div>
    <div class="col-5 titulo-assinatura">
      <b>RESPONSÁVEL PELA CONFERÊNCIA NA DRE</b>
    </div>
  </div>
  <div class="row p-0 mx-4 mt-3">
    <div class="col-6 mr-3 assinatura">
      <div class="row p-0 mx-1">
        <div class="col-2">
          <img src="{% static 'images/logo-sigpae.png' %}" alt=""/>
        </div>
        <div class="col-10 texto">
          <span>
            Documento conferido e registrado eletronicamente por {{diretor.nome}}, DIRETOR, {{diretor.registro_funcional}},
            {{solicitacao.escola.nome}} em {{data_enviado_ue}}. O registro eletrônico da Medição Inicial é comprovação
            e ateste do serviço prestado à Unidade Educacional, pela empresa {{solicitacao.rastro_terceirizada.razao_social}}.
          </span>
        </div>
      </div>
    </div>
    <div class="col-6 assinatura"></div>
  </div>
  {% for tabela in tabelas %}
    <header class="header" style="page-break-before: always;">
      <div class="row p-0 mx-4">
        <div class="col-2">
          <img src="{% static 'images/LOGO_FUNDO_CLARO.png' %}" alt=""/>
        </div>
        <div class="col-8">
          <h1 class="text-center">
            SECRETARIA MUNICIPAL DE EDUCAÇÃO - SME | COORDENADORIA DE ALIMENTAÇÃO ESCOLAR - CODAE
          </h1>
          <h1 class="text-center">
            MEDIÇÃO INICIAL DO SERVIÇO DE NUTRIÇÃO E ALIMENTAÇÃO ESCOLAR
          </h1>
        </div>
        <div class="col-1"></div>
        <div class="col-1">
          <h1 class="text-right">Página</h1>
          <h1 class="page-number text-right"></h1>
        </div>
      </div>
    </header>
    <table class="tabela-valores-medicao mt-1">
      <thead>
        <tr>
          <th rowspan="3">Dias</th>
          {% for periodo in tabela.periodos %}
            <th colspan="{{  tabela.len_periodos|get_element_by_index:forloop.counter0 }}">{{ periodo }}</th>
          {% endfor %}
        </tr>
        <tr>
          {% for categoria in tabela.categorias %}
            <th colspan="{{ tabela.len_categorias|get_element_by_index:forloop.counter0 }}">{{ categoria }}</th>
          {% endfor %}
        </tr>
        <tr>
          {% for campo in tabela.nomes_campos %}
            <th>{{ campo }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for valores in tabela.valores_campos %}
          <tr>
            {% for valor in valores %}
              <td>{{ valor }}</td>
            {% endfor %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endfor %}
  <header class="header" style="page-break-before: always;">
    <div class="row p-0 mx-4">
      <div class="col-2">
        <img src="{% static 'images/LOGO_FUNDO_CLARO.png' %}" alt=""/>
      </div>
      <div class="col-8">
        <h1 class="text-center">
          SECRETARIA MUNICIPAL DE EDUCAÇÃO - SME | COORDENADORIA DE ALIMENTAÇÃO ESCOLAR - CODAE
        </h1>
        <h1 class="text-center">
          MEDIÇÃO INICIAL DO SERVIÇO DE NUTRIÇÃO E ALIMENTAÇÃO ESCOLAR
        </h1>
      </div>
      <div class="col-1"></div>
      <div class="col-1">
        <h1 class="text-right">Página</h1>
        <h1 class="page-number text-right"></h1>
      </div>
    </div>
  </header>
  <div class="text-center mt-5 mb-5">OBSERVAÇÕES DIÁRIAS DO LANÇAMENTO</div>
  <table class="tabela-valores-medicao mt-1">
    <thead>
      <tr>
        <th>DIA</th>
        <th>PERÍODO</th>
        <th>TIPO</th>
        <th>OBSERVAÇÕES</th>
      </tr>
    <tbody>
      {% for row in tabela_observacoes %}
        <tr>
          <td>{{ row.0|safe }}</td>
          <td>{{ row.1|safe }}</td>
          <td>{{ row.2|safe }}</td>
          <td>{{ row.3|safe }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  <header class="header" style="page-break-before: always;">
    <div class="row p-0 mx-4">
      <div class="col-2">
        <img src="{% static 'images/LOGO_FUNDO_CLARO.png' %}" alt=""/>
      </div>
      <div class="col-8">
        <h1 class="text-center">
          SECRETARIA MUNICIPAL DE EDUCAÇÃO - SME | COORDENADORIA DE ALIMENTAÇÃO ESCOLAR - CODAE
        </h1>
        <h1 class="text-center">
          MEDIÇÃO INICIAL DO SERVIÇO DE NUTRIÇÃO E ALIMENTAÇÃO ESCOLAR
        </h1>
      </div>
      <div class="col-1"></div>
      <div class="col-1">
        <h1 class="text-right">Página</h1>
        <h1 class="page-number text-right"></h1>
      </div>
    </div>
    <table class="tabela-cabecalho table-bordered">
      <tr class="custom-filtros">
        <td><b>Cód. EOL: </b>{{ solicitacao.escola.codigo_eol }}</td>
        <td><b>U.E: </b>{{ solicitacao.escola.nome }}</td>
        <td><b>Telefone da UE: </b>{{ solicitacao.escola.contato.telefone }}</td>
        <td><b>DRE: </b>{{ solicitacao.escola.diretoria_regional.nome }}</td>
      </tr>
      <tr class="custom-filtros">
        <td><b>Lote: </b>{{ solicitacao.rastro_lote.nome }}</td>
        <td colspan="2"><b>Empresa Prestadora do Serviço: </b>{{ solicitacao.rastro_terceirizada.razao_social }}</td>
        <td><b>REFERÊNCIA: </b>{{ solicitacao.mes }}/{{ solicitacao.ano }}</td>
      </tr>
    </table>
  </header>
  <div class="text-center mt-5 mb-5">SOMATÓRIO DE ALIMENTAÇÕES OFERTADAS NO PERÍODO</div>
  <table class="tabela-valores-medicao mt-1">
    <thead>
      <tr>
        <th>Tipos de Alimentação</th>
        {% for periodo in tabela_somatorio_lista_periodos %}
          <th>{{ periodo }}</th>
        {% endfor %}
        <th>Total</th>
      </tr>
    <tbody>
      {% for campo in tabela_somatorio_lista_campos %}
        <tr>
          <td>{{ campo }}</td>
          {% for periodo in tabela_somatorio_lista_periodos %}
            <td>{% get_valor_somatorio_campo_periodo tabela_somatorio campo periodo %}</td>
          {% endfor %}
          <td>{% total_periodo_ou_campo_medicao tabela_somatorio campo %}</td>
        </tr>
      {% endfor %}
      <tr>
        <td>Total</td>
        {% for periodo in tabela_somatorio_lista_periodos %}
          <td>{% total_periodo_ou_campo_medicao tabela_somatorio periodo %}</td>
        {% endfor %}
        <td>{{ tabela_somatorio|get_total_medicao }}</td>
      </tr>
    </tbody>
  </table>
</body>
</html>
