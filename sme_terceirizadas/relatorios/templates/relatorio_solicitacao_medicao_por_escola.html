{% load index %}
{% load static %}
{% load sass_tags %}

<html>
<head>
  <link rel="stylesheet" href="{% sass_src 'css/cabecalho.scss' %}" type="text/css">
  <link rel="stylesheet" href="{% sass_src 'css/relatorio_solicitacao_medicao_por_escola.scss' %}" type="text/css">
  <link rel="stylesheet" href="{% sass_src 'css/custom_bootstrap.scss' %}" type="text/css">
</head>
<body>
  <header class="header">
    <section class="titulo-e-logo">
      <img class='custom-logo' src="{% static 'images/LOGO_PB_POSITIVO.png' %}" alt=""/>
      <h1 class='custom-title'>
        SECRETARIA MUNICIPAL DE EDUCAÇÃO - SME | COORDENADORIA DE ALIMENTAÇÃO ESCOLAR - CODAE <br/>
        MEDIÇÃO INICIAL DO SERVIÇO DE NUTRIÇÃO E ALIMENTAÇÃO ESCOLAR
      </h1>
    </section>
    <table class="tabela-cabecalho">
      <tr class="custom-filtros">
        <td><b>Cód. EOL: </b>{{ solicitacao.escola.codigo_eol }}</td>
        <td><b>U.E: </b>{{ solicitacao.escola.nome }}</td>
        <td><b>Telefone da UE: </b>{{ solicitacao.escola.contato.telefone }}</td>
        <td><b>DRE: </b>{{ solicitacao.escola.diretoria_regional.nome }}</td>
      </tr>
      <tr class="custom-filtros">
        <td><b>Lote: </b>{{ solicitacao.rastro_lote.nome }}</td>
        <td colspan="2"><b>Empresa Prestadora do Serviço: </b>{{ solicitacao.rastro_terceirizada.razao_social }}</td>
        <td><b>REFERÊNCIA: </b>{{ solicitacao.mes }}/{{ solicitacao.ano }}</td>
      </tr>
    </table>
  </header>
  <div class="text-center mt-5 mb-5">INFORMAÇÕES BÁSICAS DA MEDIÇÃO</div>
  {% for tabela in tabelas %}
    <header class="header" style="page-break-before: always;">
     <section class="titulo-e-logo">
        <img class='custom-logo' src="{% static 'images/LOGO_PB_POSITIVO.png' %}" alt=""/>
        <h1 class='custom-title'>
          SECRETARIA MUNICIPAL DE EDUCAÇÃO - SME | COORDENADORIA DE ALIMENTAÇÃO ESCOLAR - CODAE <br/>
          MEDIÇÃO INICIAL DO SERVIÇO DE NUTRIÇÃO E ALIMENTAÇÃO ESCOLAR
        </h1>
     </section>
    </header>
    <table class="tabela-valores-medicao mt-1">
      <thead>
        <tr>
          <th rowspan="3">Dias</th>
          {% for periodo in tabela.periodos %}
            <th colspan="{{  tabela.len_periodos|get_element_by_index:forloop.counter0 }}">{{ periodo }}</th>
          {% endfor %}
        </tr>
        <tr>
          {% for categoria in tabela.categorias %}
            <th colspan="{{ tabela.len_categorias|get_element_by_index:forloop.counter0 }}">{{ categoria }}</th>
          {% endfor %}
        </tr>
        <tr>
          {% for campo in tabela.nomes_campos %}
            <th>{{ campo }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for valores in tabela.valores_campos %}
          <tr>
            {% for valor in valores %}
              <td>{{ valor }}</td>
            {% endfor %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endfor %}
  <header class="header" style="page-break-before: always;">
     <section class="titulo-e-logo">
        <img class='custom-logo' src="{% static 'images/LOGO_PB_POSITIVO.png' %}" alt=""/>
        <h1 class='custom-title'>
          SECRETARIA MUNICIPAL DE EDUCAÇÃO - SME | COORDENADORIA DE ALIMENTAÇÃO ESCOLAR - CODAE <br/>
          MEDIÇÃO INICIAL DO SERVIÇO DE NUTRIÇÃO E ALIMENTAÇÃO ESCOLAR
        </h1>
     </section>
  </header>
  <div class="text-center mt-5 mb-5">OBSERVAÇÕES DIÁRIAS DO LANÇAMENTO</div>
  <table class="tabela-valores-medicao mt-1">
    <thead>
      <tr>
        <th>DIA</th>
        <th>PERÍODO</th>
        <th>TIPO</th>
        <th>OBSERVAÇÕES</th>
      </tr>
    <tbody>
      {% for row in tabela_observacoes %}
        <tr>
          <td>{{ row.0|safe }}</td>
          <td>{{ row.1|safe }}</td>
          <td>{{ row.2|safe }}</td>
          <td>{{ row.3|safe }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  <header class="header" style="page-break-before: always;">
    <section class="titulo-e-logo">
      <img class='custom-logo' src="{% static 'images/LOGO_PB_POSITIVO.png' %}" alt=""/>
      <h1 class='custom-title'>
        SECRETARIA MUNICIPAL DE EDUCAÇÃO - SME | COORDENADORIA DE ALIMENTAÇÃO ESCOLAR - CODAE <br/>
        MEDIÇÃO INICIAL DO SERVIÇO DE NUTRIÇÃO E ALIMENTAÇÃO ESCOLAR
      </h1>
    </section>
    <table class="tabela-cabecalho">
      <tr class="custom-filtros">
        <td><b>Cód. EOL: </b>{{ solicitacao.escola.codigo_eol }}</td>
        <td><b>U.E: </b>{{ solicitacao.escola.nome }}</td>
        <td><b>Telefone da UE: </b>{{ solicitacao.escola.contato.telefone }}</td>
        <td><b>DRE: </b>{{ solicitacao.escola.diretoria_regional.nome }}</td>
      </tr>
      <tr class="custom-filtros">
        <td><b>Lote: </b>{{ solicitacao.rastro_lote.nome }}</td>
        <td colspan="2"><b>Empresa Prestadora do Serviço: </b>{{ solicitacao.rastro_terceirizada.razao_social }}</td>
        <td><b>REFERÊNCIA: </b>{{ solicitacao.mes }}/{{ solicitacao.ano }}</td>
      </tr>
    </table>
  </header>
  <div class="text-center mt-5 mb-5">SOMATÓRIO DE ALIMENTAÇÕES OFERTADAS NO PERÍODO</div>
  <table class="tabela-valores-medicao mt-1">
    <thead>
      <tr>
        <th>Tipos de Alimentação</th>
        {% for periodo in tabela_somatorio_lista_periodos %}
          <th>{{ periodo }}</th>
        {% endfor %}
        <th>Total</th>
      </tr>
    <tbody>
      {% for campo in tabela_somatorio_lista_campos %}
        <tr>
          <td>{{ campo }}</td>
          {% for periodo in tabela_somatorio_lista_periodos %}
            <td>{% get_valor_somatorio_campo_periodo tabela_somatorio campo periodo %}</td>
          {% endfor %}
          <td>{% total_periodo_ou_campo_medicao tabela_somatorio campo %}</td>
        </tr>
      {% endfor %}
      <tr>
        <td>Total</td>
        {% for periodo in tabela_somatorio_lista_periodos %}
          <td>{% total_periodo_ou_campo_medicao tabela_somatorio periodo %}</td>
        {% endfor %}
        <td>{{ tabela_somatorio|get_total_medicao }}</td>
      </tr>
    </tbody>
  </table>
</body>
</html>
